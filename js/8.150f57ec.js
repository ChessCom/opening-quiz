"use strict";(self["webpackChunkopening_quiz"]=self["webpackChunkopening_quiz"]||[]).push([[8],{4008:function(e,n,t){t.r(n),t.d(n,{create:function(){return E}});var o,i=t(2198),s=t(1495),r=t(6352);t(4114);function u(e){let n=[];return{cancel:t,confirm:i,get:s,getActiveGuess:u,guess:a,reset:l};function t(){const{api:t,respond:i}=e,s=u();s&&(n.pop(),i(r.i.APIEvents.SetBoardPosition,{pieces:t.getPieces()}),i(o.APIEvents.CancelGuess,s))}function i(n){const{respond:t}=e,i=c();i&&(Object.assign(i,{confirmed:!0,correct:n}),t(o.APIEvents.GuessConfirmed,i))}function s(){return n}function u(){const e=c();return(null==e?void 0:e.confirmed)?void 0:e}function c(){return n[n.length-1]}function a(t){var i;const{api:s,respond:r}=e,u={...t,confirmed:!1,correct:!1,ids:(null==(i=s.getSelectedNode())?void 0:i.ids)??{line:0,move:0}};n.push(u),r(o.APIEvents.GuessMade,u)}function l(){n=[]}}(e=>{(e=>{e.Name="guessTheMove"})(e.Plugin||(e.Plugin={})),(e=>{e["CancelGuess"]="CancelGuess",e["GuessConfirmed"]="GuessConfirmed",e["GuessMade"]="GuessMade"})(e.APIEvents||(e.APIEvents={})),(e=>{e["Correct"]="#96bc4b",e["Incorrect"]="#c93430"})(e.Colors||(e.Colors={}))})(o||(o={}));var c=t(8282);function a(e){const{api:n,game:t,respond:o}=e,i=n.move;return function(e){const t=(0,c.B)(e,n.getFEN(),n.getVariant());return t?t.userGenerated?u(t):s(t):o(r.i.APIEvents.IllegalMove)};function s(e){const t={...e},o=n.guessTheMove.getActiveGuess(),s=n.getMove(e);if(!s||!o)return n.isAtEndOfLine()?i(e):n.addMoveToEndOfLine(t);const r=s.color===n.getPlayingAs()&&s.san===o.san;return e.animate=!r,n.reload(),i(e),n.guessTheMove.confirm(r)}function u(e){if(n.isLegalMove(e)){const i=t.move(e);if(!i)return o(r.i.APIEvents.IllegalMove);n.guessTheMove.guess(i);const s={...n.getPieces()};return t.undo(),o(r.i.APIEvents.SetBoardPosition,{pieces:s})}return o(r.i.APIEvents.IllegalMove)}}var l=t(8696),d=t(43);const v="gtm";function f(e,n){var t;const{api:o,options:i}=n,s=null==(t=o.guessTheMove)?void 0:t.getActiveGuess();if(!i||!i.allowMarkings||!s)return[];const r=[];if(s.from){const e=(0,l.t)({color:i.premoveHighlightColor,opacity:i.premoveHighlightOpacity,square:s.from,type:v});r.push(e)}const u=(0,l.t)({color:i.premoveHighlightColor,opacity:i.premoveHighlightOpacity,square:(0,d.v)(s),type:v});return r.push(u),r}var g=t(5271),p=t(8573),h=t(4863);function M(){let e=!1;return{api:u,apiOverrides:{move:a},beforeState:[{condition:(0,h.is)(r.i.UserEvents.PointerdownRight),handler:t}],destroy:i,match:[{condition:(0,g.E)(p.n),handler:c},{condition:(0,g.E)(o.APIEvents),handler:n},{condition:(0,h.is)(o.APIEvents.GuessConfirmed),handler:s}],name:o.Plugin.Name};function n(n,t){var o,i;if(e)return;const{api:s}=t;null==(o=s.highlights)||o.addModule(f),((null==(i=s.highlights)?void 0:i.getModules())??[]).find((e=>"getGuessTheMoveHighlights"===e.name))&&(e=!0)}function t(e,{api:n,queue:t}){return!n.guessTheMove.getActiveGuess()||(t.add(n.guessTheMove.cancel),!1)}function i(e){var n;const{api:t}=e;null==(n=t.highlights)||n.removeModule(f)}function s(e,n){const{api:t}=n,{correct:i,ids:s}=e.data;t.updateNode(s,{customColor:i?o.Colors.Correct:o.Colors.Incorrect})}function c(e,n){const{api:t,queue:o}=n;e.type===r.i.APIEvents.Load&&t.guessTheMove.reset();const i=t.getTurn();o.add(t.setPlayingAs,i)}}var m=t(805);function A({api:e}){return{isAllowedToMove:n,handleIllegalMove:(0,m.I)(e),name:s.d.Types.GuessTheMove,plugins:[M()],usePlayingAs:!0};function n(){return e.guessTheMove&&e.isAtEndOfLine()&&!e.guessTheMove.getActiveGuess()}}const E=(0,i.k)(A,{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}})},2198:function(e,n,t){t.d(n,{k:function(){return u}});var o=t(6352),i=t(813);function s(e,n){return function(t){const o=Object.entries(t).map((([t,o])=>{var i;if(!o||!(null==(i=e.overridableMethods)?void 0:i.includes(t)))return;const s=e[t];return e[t]=o(e,n),function(){e[t]=s}}));return function(){o.map((e=>null==e?void 0:e()))}}}function r({base:e,initialOptions:n}){return function(t){const r=Object.keys(n).reduce(((e,t)=>(e[t]=n[t].default,e)),{}),u=e({api:t,options:r}),a=s(u,t);return Object.assign(u,{extendMode:a,getOptions:l,setOption:d});function l(){return r}function d(e,s){var u;(null==(u=n[e])?void 0:u.editable)?(r[e]=s,t.emit(o.i.OptionsEvents.UpdateMode,(0,i.e)(o.i.OptionsEvents.UpdateMode,{[e]:s}))):c(e)}}}function u(e,n){return function(t={}){const o=Object.keys(t).reduce(((e,o)=>{var i;return(null==(i=n[o])?void 0:i.editable)?Object.assign(e,{[o]:{default:t[o],editable:!0}}):c(o),e}),n);return r({base:e,initialOptions:o})}}function c(e){console.warn(`${e} is not an editable option in this mode.`)}},805:function(e,n,t){function o(e){return function(){e.isAtEndOfLine()||e.selectLineEnd()}}t.d(n,{I:function(){return o}})}}]);
//# sourceMappingURL=8.150f57ec.js.map