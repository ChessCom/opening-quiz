"use strict";(self["webpackChunkopening_quiz"]=self["webpackChunkopening_quiz"]||[]).push([[144],{2198:function(n,e,t){t.d(e,{k:function(){return r}});var i=t(6352),o=t(813);function s(n,e){return function(t){const i=Object.entries(t).map((([t,i])=>{var o;if(!i||!(null==(o=n.overridableMethods)?void 0:o.includes(t)))return;const s=n[t];return n[t]=i(n,e),function(){n[t]=s}}));return function(){i.map((n=>null==n?void 0:n()))}}}function a({base:n,initialOptions:e}){return function(t){const a=Object.keys(e).reduce(((n,t)=>(n[t]=e[t].default,n)),{}),r=n({api:t,options:a}),l=s(r,t);return Object.assign(r,{extendMode:l,getOptions:c,setOption:u});function c(){return a}function u(n,s){var r;(null==(r=e[n])?void 0:r.editable)?(a[n]=s,t.emit(i.i.OptionsEvents.UpdateMode,(0,o.e)(i.i.OptionsEvents.UpdateMode,{[n]:s}))):d(n)}}}function r(n,e){return function(t={}){const i=Object.keys(t).reduce(((n,i)=>{var o;return(null==(o=e[i])?void 0:o.editable)?Object.assign(n,{[i]:{default:t[i],editable:!0}}):d(i),n}),e);return a({base:n,initialOptions:i})}}function d(n){console.warn(`${n} is not an editable option in this mode.`)}},1826:function(n,e,t){function i({api:n,followAlternateLines:e=!1,mv:t}){const{game:i,mutateGame:o}=n.getContext(),s=o((function(){i.moveForward(e,t)}));return!!(null==s?void 0:s.plyDiff)&&(i.moveBackward(),!0)}t.d(e,{h:function(){return i}})},3052:function(n,e,t){var i;t.d(e,{A:function(){return a}}),(n=>{(n=>{n.Name="analysis-overlay"})(n.Plugin||(n.Plugin={}))})(i||(i={}));var o=t(6352),s=t(5271);function a(){let n;return{destroy:e,match:[{condition:(0,s.E)([o.i.APIEvents.Load,o.i.OptionsEvents.Update,o.i.InstanceEvents.ModeChanged,o.i.InstanceEvents.RendererSet]),handler:t}],name:i.Plugin.Name};function e(){null==n||n.removeAnalysisOverlay()}function t(e,t){const{options:i,renderer:o}=t;!n&&o&&(n=o),i.overlayInAnalysisMode?null==n||n.addAnalysisOverlay():null==n||n.removeAnalysisOverlay()}}},5144:function(n,e,t){t.r(e),t.d(e,{create:function(){return H}});var i=t(2198),o=t(3052),s=t(9335);function a(n){const{api:e,respond:t}=n,i=e.load;return function(n,o){const a=e.observing;return a.setCachedPGN(""),a.isAnalyzing()&&(a.clearCachedIds(),t(s.b.APIEvents.AnalysisEnd)),i(n,o)}}var r=t(8387),d=t(1826),l=t(6352),c=t(9486);function u(n){return Boolean(n&&"san"in n&&"--"===n.san)}function v({move:n,api:e,game:t}){const i=e.observing,o=t.ids();t.selectPosition(0,0),t.createVariation(),t.move(n);const s=e.getRawLines().length-1;t.promoteVariation(s,0),t.deletePosition(0,s);const{playSounds:a}=e.getOptions();a&&e.setOptions({playSounds:!1});const r=i.getCachedIds();r&&i.clearCachedIds(),e.load({pgn:e.getPGN()}),a&&e.setOptions({playSounds:!0}),r&&i.setCachedIds(r.move,r.line),e.selectNode(o.line,o.move)}var f=t(8282);function g(n){const{api:e,respond:t,game:i}=n,o=e.move;return function(n){const t=e.observing.getCachedPGN();t&&e.load({pgn:t});const i=(0,f.B)(n,e.getFEN(),e.getVariant());return i?i.userGenerated?a(i):g(i):o(n)};function a(n){var a;const v=e.observing,{move:f,line:g}=i.ids(),p=v.isAnalyzing(),m=(0,c.u)(g);0===(null==(a=e.getLine(0))?void 0:a.length)&&i.move("--");const h=e.getNodeByIds({line:0,move:0});if(u(h)&&u(e.getSelectedNode())&&e.selectNode(0,-1),u(h)&&"san"in n){const t=r.A.sanToObj(n.san,e.getFEN());Object.assign(n,t),n.san=""}m&&!(0,d.h)({api:e,followAlternateLines:!0,mv:n})&&e.isAtEndOfLine()&&e.createContinuation();const A=o(n);if((null==A?void 0:A.type)!==l.i.APIEvents.Move)return A;const y=(0,c.u)(i.ids().line);return!m||y||p||(v.setCachedIds(f,g),t(s.b.APIEvents.AnalysisStart)),A}function g(n){const t=e.observing,s=u(e.getNodeByIds({line:0,move:0})),a=e.getLine(0);if(!s||1!==(null==a?void 0:a.length))return t.isAnalyzing()||!e.isAtEndOfLine()?e.addMoveToEndOfLine(n,0):o(n,!1);v({move:n,api:e,game:i})}}function p({api:n}){const e=n.moveForward;return function(t,i){return e(o(),i);function o(){return t??(!!n.observing.isAnalyzing()&&void 0)}}}function m(n){const{api:e}=n;return function(n,t){const i=e.observing;if(!i.isAnalyzing())return;if(u(e.getNodeByIds({line:0,move:0}))){const n=e.getPGN();return e.load({pgn:"*"}),void i.setCachedPGN(n)}const o=i.getCachedIds();n?e.load(n,t):e.load({pgn:e.getPGN()}),o&&e.selectNode(o.line,o.move)}}function h(n){let e,t="";return{clearCachedIds:i,getCachedIds:o,isAnalyzing:s,restorePosition:m(n),setCachedIds:a,setCachedPGN:r,getCachedPGN:d};function i(){e=void 0}function o(){return e}function s(){return Boolean(e)}function a(n,t){e={move:n,line:t}}function r(n){t=n}function d(){return t}}var A=t(5271),y=t(4863);function I(...n){return function(e,t){return Boolean(n.find((n=>n(e,t))))}}var b=t(24);function P({data:n}){return void 0!==n.lineDiff&&0!==n.lineDiff}function N(n,e){return!E(n,e)}function E(n,{api:e}){return e.observing.isAnalyzing()}function O(n,e){const{api:t}=e;return u(t.getNodeByIds({line:0,move:0}))}function M(n,e){const{api:t}=e;return!u(t.getNodeByIds({line:0,move:0}))}function C(n,e){const{api:t}=e;return u(t.getSelectedNode())}function L(n,e){var t,i;const{api:o}=e,s=o.getSelectedNode();return 0===(null==(t=null==s?void 0:s.ids)?void 0:t.line)&&-1===(null==(i=null==s?void 0:s.ids)?void 0:i.move)}function S(n,e){const{api:t}=e,i=t.getSelectedNode();return Boolean(i&&0!==i.ids.line)}function w(n,e){const{api:t}=e,i=t.getLine(1);return Boolean(!i||0===i.length)}function B(n,e){var t;const{data:i}=n;return Boolean(0===(null==(t=i.line)?void 0:t.atMoveNode))}function z(n,e){if(!n)return null;if(0===n.line)return n;const t=e[n.line];return t&&void 0!==t.parentId&&void 0!==t.atMoveNode?z({line:t.parentId,move:t.atMoveNode},e):null}function G(n,e){const{api:t,queue:i}=e;t.observing.isAnalyzing()||i.add((function(){var n;const e=z(null==(n=t.getSelectedNode())?void 0:n.ids,t.getRawLines());e&&(t.observing.setCachedIds(e.move,e.line),t.getContext().respond(s.b.APIEvents.AnalysisStart))}))}function k(n,e){const{api:t,queue:i}=e;i.add((function(){t.selectNode(1,0)}))}function j(n,e){const{api:t,queue:i}=e,o=t.getLine(1);if(o){const n=Math.max(...o.map((n=>n.moveNumber)));i.add((function(){t.selectNode(1,n)}))}}function q(n,e){const{api:t}=e,i=t.observing;t.deletePosition(0,0),i.setCachedPGN(""),i.restorePosition()}function F(n,e){const{api:t,queue:i}=e;i.add((function(){t.selectNode(0,-1)}))}function T(n,e){const{api:t}=e,i=t.observing,{overlayInAnalysisMode:o}=t.getOptions(),s=i.isAnalyzing();s!==o&&t.setOptions({overlayInAnalysisMode:s})}function D(n,e){const{api:t}=e,i=t.observing;i.restorePosition()}function x(n,e){const{api:t,queue:i}=e;i.add((function(){t.selectNode(0,0)}))}var R=t(8573);function U(n,e){var t,i,o,s;const{api:a}=e,r=a.observing,d=null==(t=a.getSelectedNode())?void 0:t.ids;if(!d)return;if(0===d.line)return void r.setCachedIds(d.move,d.line);let l=null==(i=a.getLine(d.line))?void 0:i.id;if(!l)return;while(null==(o=a.getLine(l))?void 0:o.parentId){const n=null==(s=a.getLine(l))?void 0:s.parentId;if("number"===typeof n&&(l=n),!n)break}const c=a.getLine(l);let u=(null==c?void 0:c.atMoveNode)??0;(null==c?void 0:c[0].isContinuation)||(u-=1),r.setCachedIds(u,0)}function V(){return[{condition:(0,A.E)([s.b.APIEvents.AnalysisStart,s.b.APIEvents.AnalysisEnd]),handler:T},{condition:(0,b.l)((0,A.E)(R.n),E),handler:U},{condition:(0,b.l)((0,y.is)(l.i.APIEvents.ResetToMainLine),O),handler:q},{condition:(0,b.l)((0,y.is)(l.i.APIEvents.ResetToMainLine),M),handler:D},{condition:(0,b.l)((0,y.is)(l.i.APIEvents.DeletePosition),O,w),handler:q},{condition:(0,b.l)((0,y.is)(l.i.APIEvents.DeletePosition),O,B),handler:x},{condition:(0,b.l)((0,y.is)(l.i.APIEvents.DeletePosition),M,w),handler:D},{condition:(0,b.l)((0,y.is)(l.i.APIEvents.SelectNode),C),handler:F},{condition:(0,b.l)((0,y.is)(l.i.InstanceEvents.ModeChanged),S),handler:G},{condition:(0,b.l)((0,y.is)(l.i.APIEvents.SelectNode),M,S),handler:G},{condition:(0,b.l)((0,y.is)(l.i.APIEvents.MoveForward),N,P),handler:G},{condition:(0,b.l)((0,y.is)(l.i.APIEvents.MoveForward),O,I(C,L)),handler:k},{condition:(0,b.l)((0,y.is)(l.i.APIEvents.SelectLineEnd),O,I(C,L)),handler:j}]}function _(){return{api:h,apiOverrides:{load:a,move:g,moveForward:p},create:n,match:V(),name:s.b.Plugin.Name};function n(n){const{api:e}=n;e.setOptions({overlayInAnalysisMode:!1})}}var W=t(1495);function $(){return{isAllowedToMove:n,name:W.d.Types.Observing,plugins:[(0,o.A)(),_()]};function n(){return!0}}const H=(0,i.k)($,{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}})}}]);
//# sourceMappingURL=144.bacef27e.js.map